---
title: Derivation of PRML (4.68)
author: Lei Yan
date: '2019-04-25'
slug: derivation-of-prml-4-68
categories:
  - Machine Learning
tags:
  - Classification
---



<p>From <span class="math inline">\((4.62)\)</span> we know that
<span class="math display">\[
\begin{aligned}
p(\mathcal{C}_k|x) 
&amp;= \frac{p(x|\mathcal{C}_k)p(\mathcal{C}_k)}{\sum_j p(x|\mathcal{C}_j)p(\mathcal{C}_j)} \\
&amp;= \frac{exp(a_k)}{\sum_j exp(a_j)}
\end{aligned}\tag{1}
\]</span>
Now, we should focus on the right hand of first equal sign.<br />
Using the assumption that <span class="math inline">\(p(x|\mathcal{C}_k)\)</span> is a normal distribution and all classes share the same covariance matrix, we have:</p>
<p><span class="math display">\[
\begin{aligned}
p(\mathcal{C}_k|x) 
=&amp; \frac{p(x|\mathcal{C}_k)p(\mathcal{C}_k)}{\sum_j p(x|\mathcal{C}_j)p(\mathcal{C}_j)} \\
=&amp; \frac{(2\pi^{-D/2})|\Sigma|^{-1/2}exp\{\frac{1}{2}x^T\Sigma^{-1} x\}exp\{x^T\Sigma^{-1}\mu_k-\frac{1}{2}\mu_k^T\Sigma^{-1}\mu_k\}p(\mathcal{C}_k)}{\sum_j(2\pi^{-D/2})|\Sigma|^{-1/2}exp\{\frac{1}{2}x^T\Sigma^{-1} x\}exp\{x^T\Sigma^{-1}\mu_j-\frac{1}{2}\mu_k^T\Sigma^{-1}\mu_j\}p(\mathcal{C}_j)} \\
=&amp; \frac{exp\{x^T\Sigma^{-1}\mu_k-\frac{1}{2}\mu_k^T\Sigma^{-1}\mu_k\}p(\mathcal{C}_k)}{\sum_jexp\{x^T\Sigma^{-1}\mu_j-\frac{1}{2}\mu_k^T\Sigma^{-1}\mu_j\}p(\mathcal{C}_j)} 
\end{aligned}
\]</span>
Next, we can put <span class="math inline">\(p(\mathcal{C}_k)\)</span> into <span class="math inline">\(exp\)</span>:</p>
<p><span class="math display">\[
\frac{exp\{x^T\Sigma^{-1}\mu_k-\frac{1}{2}\mu_k^T\Sigma^{-1}\mu_k + ln(p(\mathcal{C}_k))\}}{\sum_jexp\{x^T\Sigma^{-1}\mu_j-\frac{1}{2}\mu_k^T\Sigma^{-1}\mu_j+ ln(p(\mathcal{C}_j))\}} = \frac{exp(a_k)}{\sum_j exp(a_j)}
\]</span></p>
<p>Therefore, <span class="math inline">\(a_k \neq ln(p(x|\mathcal{C}_k)p(\mathcal{C}_k))\)</span>, which according to <span class="math inline">\((4.63)\)</span> the <span class="math inline">\(\neq\)</span> should be <span class="math inline">\(=\)</span>. I think this might be an error.</p>
<p>So, we have
<span class="math display">\[
a_k(x) = x^T\Sigma^{-1}\mu_k-\frac{1}{2}\mu_k^T\Sigma^{-1}\mu_k + ln(p(\mathcal{C}_k)
\]</span></p>
